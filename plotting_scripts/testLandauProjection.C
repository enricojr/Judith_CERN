#include <iostream>
#include <cmath>

#include "Rtypes.h"

//#include "AtlasUtils.h"
//#include "AtlasStyle.h"
//#include "AtlasLabels.h"
// #ifndef __CINT__
// these are not headers - do not treat them as such
// #include "AtlasStyle.C"
// #include "AtlasLabels.C"
// #endif

#include "TCanvas.h"
#include "TFile.h"
#include "TROOT.h"
#include "TH1F.h"
#include "TRandom.h"
#include "TGraphErrors.h"

using namespace std;

const Int_t GMAX=864;

const int nren=3;
static const double mur[nren] = {1.0,0.25,4.0};
static const double muf[nren] = {1.0,0.25,4.0};
const unsigned int NUMPDF=41;

TGraphErrors* GetGraph(Int_t ir, Int_t ifs,Int_t icut, Int_t ipdf);
TMultiGraph *mg;
TGraphErrors *gr1;
TGraphErrors *gr2;

void setStyle(){
    
    gROOT->LoadMacro("/Users/schae/testarea/CAFAna/HWWMVACode/atlasstyle-00-03-05/AtlasStyle.C");
    gROOT->LoadMacro("/Users/schae/testarea/CAFAna/HWWMVACode/atlasstyle-00-03-05/AtlasUtils.C");
    SetAtlasStyle();
}

void testLandauProjection(bool config = true)

{
  
    
    if(config) setStyle();
//#ifdef __CINT__
//  gROOT->LoadMacro("AtlasUtils.C");
//#endif
    
  //SetAtlasStyle();

    // Corrections if needed
    TCanvas* c1 = new TCanvas("c1","testbeam efficiency",50,50,600,600);
    TMultiGraph *mg = new TMultiGraph();

    ///Graph 1 -- 120V 
    //0.00104312015633,0.00113159292547 ,0.00099289659706 , 0.00098084955868, 0.00098429624195, 0.00091238304730, 0.00082378054023, 0.00087182357526, 0.00087182357526,0.00106369956308,0.00106369956308, 0.00106369956308, 0.00106369956308   , 0.00106369956308, 0.00106369956308   , 0.00106369956308, 0.00106369956308, 0.00106369956308
//   0.00474228197709 ,0.00474228197709 , 0.00474228197709 , 0.00474228197709 , 0.00474228197709 , 0.00474228197709 , 0.00474228197709 , 0.00474228197709 ,0.00474228197709 , 0.00425991322845 ,0.00425991322845 ,0.00458957534283 ,0.00498924730346 ,0.00541943870485 ,0.00579021079466 ,0.0062612676993 ,0.0067506255582,0.00692056585103
   
    const Int_t n1 = 41;
    Double_t x1[n1]  = {-100.0,-95.0,-90.0,-85.0,-80.0,-75.0,-70.0,-65.0,-60.0,-55.0,-50.0,-45.0,-40.0,-35.0,-30.0,-25.0,-20.0,-15.0,-10.0,-5.0,0.0,5.0,10.0,15.0,20.0,25.0,30.0,35.0,40.0,45.0,50.0,55.0,60.0,65.0,70.0,75.0,80.0,85.0,90.0,95.0,100.0};
    Double_t y1[n1]  = {0.0, 0.0, 0.0, 0.00474228197709,0.00474228197709 , 0.00474228197709 , 0.00474228197709 , 0.00474228197709 , 0.00474228197709 , 0.00474228197709 , 0.00474228197709 ,0.00463552027941 , 0.00463552027941, 0.0046890177764 ,0.00481859780848 ,0.00498924730346 ,0.00541943870485 ,0.00579021079466 ,0.0062612676993 ,0.0067506255582,0.00692056585103,0.0067506255582,0.0062612676993,0.00579021079466,0.00541943870485,0.00498924730346,0.00481859780848,0.0046890177764,0.00463552027941,0.00463552027941,0.00474228197709,0.00474228197709,0.00474228197709,0.00474228197709,0.00474228197709,0.00474228197709,0.00474228197709,0.00474228197709,0.0,0.0 }; 
    Double_t ey1[n1] = {0.0,0.0,0.0, 0.00106369956308,0.00106369956308,0.00106369956308,0.00106369956308,0.00106369956308,0.00106369956308,0.00106369956308,0.00106369956308,0.00106369956308,0.00087182357526,0.00087182357526,0.00082378054023,0.0009123830473,0.00098429624195,0.00099289659706,0.00113159292547,0.00104312015633, 0.00104312015633,0.00113159292547 ,0.00099289659706 , 0.00098084955868, 0.00098429624195, 0.00091238304730, 0.00082378054023, 0.00087182357526, 0.00087182357526,0.00106369956308,0.00106369956308, 0.00106369956308, 0.00106369956308   , 0.00106369956308, 0.00106369956308   , 0.00106369956308, 0.00106369956308, 0.00106369956308, 0.0,0.0}; // variance systematic is the RMS on the mean efficiency within +/-4um

    Double_t ex1[n1] = {0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0};  
    TGraphErrors *gr1 = new TGraphErrors(n1,x1,y1,ex1,ey1);
    gr1->SetName("gr1");
    gr1->SetTitle("Hit detection efficiency vs Voltage");
    gr1->GetYaxis()->SetTitleOffset(1.60);
    gr1->GetXaxis()->SetTitle("x Residual [#mum]");
    gr1->GetYaxis()->SetTitle("Landau Most Probable Value [V]");
    gr1->GetYaxis()->SetRangeUser(0.0,0.010);
    gr1->GetXaxis()->SetRangeUser(-45.0,45.0);    
    gr1->SetMarkerColor(1);
    gr1->SetLineColor(1);
    gr1->SetFillColor(0);
    
    gr1->SetLineWidth(2);
    gr1->SetMarkerStyle(22);
    gr1->Draw();
    mg->Add(gr1);

    ////////Graph 2  -- 90V
    Double_t y2[n1]  = {0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.00409685820341,0.00409685820341,0.00409685820341,0.0041057895869,0.00419275229797,0.00444724783301,0.00481066992506,0.00518678734079,0.00566671881825,0.00576914846897,0.00566671881825,0.00518678734079,0.00481066992506,0.00444724783301, 0.00419275229797,0.0041057895869,0.00409685820341,0.00409685820341,0.00409685820341 ,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0};  
    Double_t ey2[n1] = {0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.00078987038221,0.00078987038221,0.00078987038221,0.000604618817847,0.0006164034098,0.000702523842471,0.000772946892453,0.000803833117031,0.000738457156003,0.000820810150566,0.000738457156003,0.000803833117031,0.000772946892453,0.000702523842471,0.0006164034098,0.000604618817847,0.00078987038221,0.00078987038221,0.00078987038221,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0}; // variance systematic is the RMS on the mean efficiency within +/-4um
  //
    TGraphErrors *gr2 = new TGraphErrors(n1,x1,y2,ex1,ey2);
    gr2->SetName("gr2");
    gr2->SetMarkerColor(2);
    gr2->SetLineColor(2);
    gr2->SetFillColor(0);
    
    gr2->SetLineWidth(2);
    gr2->SetMarkerStyle(21);

    ////////Graph 3  -- 60V
    Double_t y3[n1]  = {0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.00334517331794,0.00334517331794,0.00334517331794,0.00334517331794,0.00334517331794,0.00354664237238,0.00366576202214,0.00378059456125,0.00394336134195,0.00395235931501,0.00394336134195,0.00378059456125,0.00366576202214,0.00354664237238, 0.00334517331794,0.00334517331794,0.00334517331794,0.00334517331794,0.00334517331794 ,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0};  
    Double_t ey3[n1] = {0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.000588002066087,0.000588002066087,0.000588002066087,0.000588002066087,0.000568814305632,0.000510601821567,0.000547159466688,0.000567460654542,0.000632835015426,0.000591413195818,0.000632835015426,0.000567460654542,0.000547159466688,0.000510601821567,0.000568814305632,0.000588002066087,0.000588002066087,0.000588002066087,0.000588002066087,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0};
    
    TGraphErrors *gr3 = new TGraphErrors(n1,x1,y3,ex1,ey3);
    gr3->SetName("gr3");
    gr3->SetMarkerColor(3);
    gr3->SetLineColor(3);
    gr3->SetFillColor(0);
    
    gr3->SetLineWidth(2);
    gr3->SetMarkerStyle(23);

  
    gr1->Draw("same pl");
    gr2->Draw("same pl");
    gr3->Draw("same pl");
    mg->Add(gr3);
    
    TLegend *leg = new TLegend(0.45, 0.2, 0.85, 0.4);
    leg->SetBorderSize(0);
    leg->SetFillStyle(0);
    leg->AddEntry(gr3, "60V Bias");        
    leg->AddEntry(gr2, "90V Bias");    
    leg->AddEntry(gr1, "120V Bias");
    leg->Draw();

    c1->Update();
    c1->WaitPrimitive();
    
  
    //myText(       0.3,  0.85, 1, "#sqrt{s}= 14 TeV");
  //myText(       0.57, 0.85, 1, "|#eta_{jet}|<0.5");
  //myMarkerText( 0.55, 0.75, 1, 20, "Data 2009",1.3);


  


}


#ifndef __CINT__
int main() {
  testLandauProjection();
  //gPad->Print("basic.png");
  return 0;
}
#endif
